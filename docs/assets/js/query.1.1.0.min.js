"use strict";class Query{constructor(a=!1,b=!1){this.regHTML=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,this.length=0;let c=this;this.nodes=new Proxy([],{get:function(d,e){return d[e]},set:function(d,e,f){return d[e]=f,c.length=d.length,!0}}),a&&this.select(a,b)}select(a,b=!1){return this._setNodes(this._select(a,b)),this}add(a){let b=[];switch(this._type(a)){case"string":b=this._select(a);break;case"node":b=[a];break;case"Query":a.each(function(c){b.push(c)},!0);}return this._setNodes(this.nodes.concat(b)),this}_select(a,b=!1){let c=[];switch(this._type(a)){case"string":b=b||document,1!=b.nodeType&&(b=document);let d=b.querySelectorAll(a);for(let e=0;e<d.length;e++)1==d[e].nodeType&&c.push(d[e]);break;case"node":c.push(a);break;case"Query":a.each(function(e){c.push(e)},!0);}return c}_type(a){switch(typeof a){case"string":let b=a=this.regHTML.exec(a);return b?"stringHTML":"string";break;case"object":return 1==a.nodeType?"node":a instanceof Query?"Query":Object.prototype.toString.call(a).replace(/^\[object (.+)\]$/,"$1").toLowerCase();}return!1}before(a){return this._attach(a,"beforebegin"),this}after(a){return this._attach(a,"afterend"),this}start(a){return this._attach(a,"afterbegin"),this}end(a){return this._attach(a,"beforeend"),this}_attach(a,b){a=this._htmlString(a),this.nodes.forEach(function(c){c.insertAdjacentHTML(b,a)},this),this._execScripts(a)}_getNodesFromString(a){let b=[],c=new DOMParser().parseFromString(a,"text/html").querySelectorAll("body")[0].childNodes;for(let d=0;d<c.length;d++)1==c[d].nodeType&&b.push(c[d]);return b}empty(){return this.nodes.forEach(function(a){a.innerHTML=""}),this}html(a=!1){let b;return a&&(a=this._htmlString(a)),this.nodes.forEach(function(c){a?c.innerHTML=a:void 0==b&&(b=c.innerHTML)}),a&&this._execScripts(a),a?this:void 0===b?"":b}text(a=!1){let b;return this.nodes.forEach(function(c){a?c.textContent=a:void 0==b&&(b=c.textContent)}),a?this:void 0===b?"":b}_htmlString(a){switch(this._type(a)){case"node":a=a.outerHTML;break;case"Query":let b="";a.each(function(c){b+=c.outerHTML},!0),a=b;}return a}prop(a,b=!1){let c;return this.nodes.forEach(function(d){!1===b?void 0==c&&(c=d.getAttribute(a)):d.setAttribute(a,b)}),b?this:void 0===c?"":c}each(a,b=!1){return this.nodes.forEach(function(c,d){a.apply(this,[b?c:new Query(c),d])}.bind(this)),this}once(a,...b){return a.apply(this,b),this}on(a,b,c=!1){return this.nodes.forEach(function(d){d.addEventListener(a,b)}.bind(this)),this}trigger(a){return this.nodes.forEach(function(b){let c=new Event(a);b.dispatchEvent(c)}),this}off(a,b){return this.nodes.forEach(function(c){c.removeEventListener(a,b)}),this}toggle(a){return this.nodes.forEach(function(b){b.classList.toggle(a)}),this}addClass(a){return this._class(a),this}removeClass(a){return this._class(a,!0),this}_class(a,b=!1){this.nodes.forEach(function(c){b?c.classList.remove(a):c.classList.add(a)})}css(a,b=!1){let c=b?this:[];return this.nodes.forEach(function(d){switch(this._type(a)){case"string":b?d.style[a]=b:c.push(getComputedStyle(d)[a]);break;case"object":for(let e in a)d.style[e]=a[e];}}.bind(this)),b?c:1<this.nodes.length?c:c.join()}find(a){let b=[];return this.nodes.forEach(function(c){let d=c.querySelectorAll(a);for(let e in d)1==d[e].nodeType&&b.push(d[e])},this),this.nodes=b,this}parent(a=!1){let b=[];return this.nodes.forEach(function(c){let d=!1;if(a&&c.closest)d=c.closest(a);else{for(d=c.parentNode;d&&(1!=d.nodeType||!!a&&!this._matches(d,a));)d=d.parentNode;a&&!this._matches(d,a)&&(d=!1)}d&&1==d.nodeType&&b.push(d)},this),this._setNodes(b),this}is(a){let b=!1,c=this._type(a);return this.nodes.forEach(function(d){b||("string"===c?b=this._matches(d,a):"node"===c?b=d==a:"Query"===c?a.each(function(e){b||(b=d==e)},!0):void 0)},this),b}_matches(a,b){if(Element.prototype.matches)return a.matches(b);if(!a)return!1;let c=(a.parentNode||a.document).querySelectorAll(b),d=-1;for(;c[++d]&&c[d]!=a;);return!!c[d]}_setNodes(a){this.nodes.length=0,a.forEach(function(b){this.nodes.includes(b)||this.nodes.push(b)},this)}remove(){return this.nodes.forEach(function(a){a.remove()},this),this._setNodes([]),this}_execScripts(a){let b=[];switch(this._type(a)){case"stringHTML":case"string":b=this._getNodesFromString(a);}b.forEach(function(c){this._doScript(this._findScripts(c))},this)}_findScripts(a){let b=[];if("node"==this._type(a))if("script"==a.localName)b.push(a.textContent);else{let c=new Query("script",a);c.each(function(d){b.push(d.textContent)},!0)}return b}_doScript(a){a.forEach(function(b){let c=document.createElement("script"),d=document.getElementsByTagName("head")[0];c.appendChild(document.createTextNode(b)),d.insertBefore(c,d.firstChild),d.removeChild(c)})}next(a=!1){return this._sibling(!0,a),this}prev(a=!1){return this._sibling(!1,a),this}_sibling(a,b){let c=[];this.nodes.forEach(function(d){let e=a?d.nextElementSibling:d.previousElementSibling;for(;e&&(1!=e.nodeType||!b||!this._matches(e,b));)e=a?e.nextElementSibling:e.previousElementSibling;e&&1==e.nodeType&&c.push(e)},this),this._setNodes(c)}has(a){let b=!1;return this.nodes.forEach(function(c){b||(b=0<c.querySelectorAll(a).length)},this),b}filter(a){let b=[];this.nodes.forEach(function(e){b.push(new Query(e))});let c=b.filter(a),d=[];return c.forEach(function(e){d.push(e)}),this._setNodes(d),this}}